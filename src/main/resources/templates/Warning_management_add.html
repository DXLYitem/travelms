<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <title>

    </title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="../static/css/x-admin.css" media="all">
    <script src="../static/lib/layui/layui.js" charset="utf-8"></script>
    <script src="../static/js/x-layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="../static/js/jquery-3.3.1.js"></script>
    <!--<meta http-equiv="Content-Type" content="multipart/form-data; charset=utf-8" />-->
    <style>
        .red{
            color: red;
            font-size: 12px;
            display: none;
        }
    </style>
</head>

<body>
<div class="x-body">
    <form action="insertItem" method="post" id="formsubmit" enctype="multipart/form-data">
        <div class="layui-form-item">
            <label  class="layui-form-label">
                标题</label>
            <div class="layui-input-inline">
                <input type="text" class="layui-input" placeholder="如（德国 妙趣童话王国）" name="title" maxlength="15">
                <span class="red">*只能以中文或字母开头并只能写中文或之母且不能为空</span>
            </div>
        </div>
        <div class="layui-form-item">
            <label  class="layui-form-label">
                游玩时间</label>
            <div class="layui-input-inline">
                <input type="text" class="layui-input" placeholder="如(8晚10天)" name="playTime" maxlength="8">
                <span class="red">*请注意添加格式 如（8晚10天）且不能为空</span>
            </div>
        </div>
        <div class="layui-form-item">
            <label  class="layui-form-label">
                出发城市</label>
            <div class="layui-input-inline">
                <input type="text" class="layui-input" placeholder="如（北京）" name="city" maxlength="20">
                <span class="red">*只能填写中文且不能为空</span>
            </div>
        </div>
        <div class="layui-form-item">
            <label  class="layui-form-label">
                出发时间</label>
            <div class="layui-input-inline">
                <input type="text" class="layui-input" placeholder="如（2018-06-18）" name="date">
                <span class="red">*请注意添加格式 如（2018-06-18）且不能为空</span>
            </div>
        </div>
        <div class="layui-form-item">
            <label  class="layui-form-label">
                价格</label>
            <div class="layui-input-inline">
                <input type="text" class="layui-input" placeholder="如（100或100.12）" name="price">
                <span class="red">*请注意添加格式,只能输入数字 如（100或100.12）且不能为空</span>
            </div>
        </div>
        <div class="layui-form-item" >
            <label  class="layui-form-label">
                地域</label>
            <div class="layui-input-inline">
                <select id="continent" style="width: 400px;height: 40px;border: #ebebeb 1px solid;color: #8D8D8D" name="continentId">
                    <option th:value="0">请选择</option>
                    <option  th:each="con : ${conList}" th:value="${con.continentId}"><span th:text="${con.continentName}">欧洲</span></option>
                </select>
            </div>
        </div>
        <div class="layui-form-item" >
            <label  class="layui-form-label">
                地点</label>
            <div class="layui-input-inline">
                <select style="width: 400px;height: 40px;border: #ebebeb 1px solid;;color: #8D8D8D" id="ss" name="countryId">
                    <option th:value="0">请选择</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label  class="layui-form-label">
                旅行偏好</label>
            <div class="layui-input-inline">
                <select style="width: 400px;height: 40px;border: #ebebeb 1px solid;;color: #8D8D8D" name="hobbyId">
                    <option th:value="0">请选择</option>
                    <option th:each="h : ${hobbyList}" th:value="${h.hobbyId}"><span th:text="${h.hobbyName}">出游首选</span></option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label  class="layui-form-label">
               旅行主题</label>
            <div class="layui-input-inline">
                <select style="width: 400px;height: 40px;border: #ebebeb 1px solid;;color: #8D8D8D" name="travelId">
                    <option th:value="0">请选择</option>
                    <option th:each="tr : ${travelList}" th:value="${tr.travelId}"><span th:text="${tr.travelName}">亲子优选</span></option>
                </select>
            </div>
        </div>

        <div class="layui-form-item">
            <label  class="layui-form-label">
                交通工具</label>
            <div class="layui-input-inline">
                <select style="width: 400px;height: 40px;border: #ebebeb 1px solid;;color: #8D8D8D" name="trafficId">
                    <option th:value="0">请选择</option>
                    <option th:each="traff : ${trafficList}" th:value="${traff.trafficId}"><span th:text="${traff.trafficName}">商务舱</span></option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label  class="layui-form-label">
                旅行方式</label>
            <div class="layui-input-inline">
                <select style="width: 400px;height: 40px;border: #ebebeb 1px solid;;color: #8D8D8D" name="styleId">
                    <option th:value="0">请选择</option>
                    <option th:each="sy : ${styleList}" th:value="${sy.styleId}"><span th:text="${sy.styleName}">私享游</span></option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label  class="layui-form-label">
                酒店品牌</label>
            <div class="layui-input-inline">
                <select style="width: 400px;height: 40px;border: #ebebeb 1px solid;;color: #8D8D8D" name="brandId">
                    <option th:value="0">请选择</option>
                    <option th:each="br : ${brandList}" th:value="${br.brandId}"><span th:text="${br.brandName}">****</span></option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label  class="layui-form-label">
                上传图片</label>
            <div class="layui-input-inline">
                <input type="file" class="layui-input" name="picFile" id="picFile">
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label for="L_sign" class="layui-form-label">
                说明
            </label>
            <div class="layui-input-block">
                        <textarea placeholder="随便写些什么刷下存在感" id="L_sign" name="explain" autocomplete="off"
                                  class="layui-textarea" style="height: 80px;"  ></textarea>
            </div>
        </div>
        <div class="layui-form-item">
            <label for="L_sign" class="layui-form-label">
            </label>
            <p><input type="submit" id="submit"  value="提交" onclick=" return x_admin_close1()"/></p>
        </div>
    </form>
</div>

<script>
    var titleze=/^[\u4E00-\u9FA5A-Za-z][\u4E00-\u9FA5\sA-Za-z]{0,}$/;
    var playtimeze=/^[0-9]{1,2}[\u665a][0-9]{1,2}[\u5929]$/;
    var cityze=/^[\u4E00-\u9FA5]{1,}$/;
    var starttimeze=/^[0-9]{4}[-][0-9]{1,2}[-][0-9]{1,2}$/;
    var priceze=/^[0-9]{1,}[.0-9]{0,}$/;
    $("[name='title']").on("blur",function () {
        var title=$(this).val();
        if(!titleze.test(title)){
            $(this).focus();
            $(this).next().show();
            return;
        }
        $(this).next().hide();
    });
    $("[name='playTime']").on("blur",function () {
        var playtime=$(this).val();
        if(!playtimeze.test(playtime)){
            $(this).focus();
            $(this).next().show();
            return;
        }
        $(this).next().hide();
    });
    $("[name='city']").on("blur",function () {
        var city=$(this).val();
        if(!cityze.test(city)){
            $(this).focus();
            $(this).next().show();
            return;
        }
        $(this).next().hide();
    });
    $("[name='date']").on("blur",function () {
        var his=$(this);
        var str;
        var date=$(this).val();
        if(!starttimeze.test(date)){
            str="**请注意添加格式（2018-06-18）且不能为空"
            mes(his,str);
            return;
        }
        var starttime=$(this).val();
        var month=starttime.split("-");
        if(month[1]>12 || month[1]<0){
            str="*月份输入错误"
            mes(his,str);
            return;
        }
        if(month[1]==1||month[1]==3||month[1]==5||month[1]==7||month[1]==8||month[1]==10||month[1]==12) {
            if(month[2]>31||month[2]<0){
                str="*day输入错误";
                mes(his,str);
                return;
            }
        }else if(month[1]==4||month[1]==6||month[1]==9||month[1]==11){
            if(month[2]>30||month[2]<0){
                str="*day输入错误";
                mes(his,str);
                return;
            }
        }else{
            if(month[0]%4==0){
                if(month[2]>29||month[2]<0){
                    str="*day输入错误";
                    mes(his,str);
                    return;
                }
            }else{
                if(month[2]>28||month[2]<0){
                    str="*day输入错误";
                    mes(his,str);
                    return;
                }
            }
        }
        starttime=Date.parse(starttime);
        var time=new Date(starttime);
        var now=new Date();
        if(now>time){
            str="*时间不能在当前时间之前"
            mes(his,str);
            return;
        }
        $(this).next().hide();
    });
    $("[name='price']").on("blur",function () {
        var price=$(this).val();
        if(!priceze.test(price)){
            $(this).focus();
            $(this).next().show();
            return;
        }
        $(this).next().hide();
    });

    function x_admin_close1(){
        var num=0;
        var count=0;
        var flag=true;
        $("input[type='text']").each(function () {
            if($(this).val()==""||$(this).val()==NaN || $(this).val()==undefined || $(this).val()==null){
                $(this).focus();
                $(this).next().show();
            }
        })
        $("select option:selected").each(function(){
            num=num+1;
            if(num==1||num==2){
                if($(this).val()==0){
                    parent.layer.msg('请选择地域和地区', {icon: 0});
                    flag=false;
                    return false;
                }
            }
            for (var i=0;i<num;i++){
                if(num>=3&& num<7){
                    count=count+parseInt($(this).val());
                }
            }
        })
        if(!flag){
            return false;
        }
        if(count==0){
            parent.layer.msg('请在 旅行偏好 旅行主题 交通工具 旅行方式中至少选一个', {icon: 0});
            return false;
        }

        var index = parent.layer.getFrameIndex(window.name);
        parent.layer.close(index);
    }

function mes(thi,e){
    thi.focus();
    thi.next().text(e);
    thi.next().show();
}

    $(function () {
        $("#continent").on("change",function(){
            var conId=$(this).val();
            $.ajax({
                url:"selectCountry",
                data:{"continentId":conId},
                dataType:"json",
                type:"post",
                success(data){
                    $("#ss").children().filter("option").remove();
                    for (var i = 0; i < data.length; i++) {
                        var html =
                            '<option value='+data[i].countryId+'>' + data[i].countryName + '</option>';
                        $.each($("#ss"), function (i, t) {
                            $(t).html(html + $(t).html())
                        })
                    }
                }
            })
        });
    })


</script>
<script>

    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>

</html>